<section class="content-header">
    <h1>Ofertas</h1>
    <ol class="breadcrumb">
        <li class="active">
            <i class="fa fa-dollar-sign"></i> Ofertas</li>
    </ol>
</section>
<section class="content container-fluid">
    <div class="row">
        <div class="col-md-8">
            <div class="box">
                <div class="box-header">
                    <h3 class="box-title">
                        Ofertas da Winehouse
                    </h3>
                </div>
                <div class="box-body">
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>Produto</th>
                                    <th>Estoque Atual</th>
                                    <th>Embalagem</th>
                                    <th>Valor</th>
                                    <th>Ativo</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr id="oferta_{{oferta.id}}" dir-paginate="oferta in ListaOfertas | itemsPerPage:15"
                                    pagination-id="pagOfertas">
                                    <td>{{oferta.product}}</td>
                                    <td>{{oferta.estoque}}</td>
                                    <td>{{oferta.package_name}} <small>({{oferta.package_size}})</small></td>
                                    <td>{{'R$'+oferta.price}}</td>
                                    <td>
                                        <input bs-switch type="checkbox" ng-model="oferta.active" switch-on-text=" "
                                            switch-off-text=" " switch-on-color="success" switch-off-color="danger"
                                            switch-change="DefineStatusOferta(oferta)" switch-size="small" />
                                    </td>
                                    <td class="text-center">
                                        <button class="btn btn-xs btn-warning" ng-click="AlteraOferta(oferta)">
                                            <i class="fa fa-pencil-alt"></i>
                                        </button>
                                        <button class="btn btn-xs btn-danger" ng-click="ExcluiOferta(oferta)">
                                            <i class="fa fa-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <dir-pagination-controls pagination-id="pagOfertas" class="pull-right"></dir-pagination-controls>
                </div>
                <div class="overlay" ng-if="load">
                    <i class="fa fa-sync fa-spin"></i>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="box box-warning" ng-if="OfertaAlterar">
                <div class="box-header">
                    <h3 class="box-title">Alterar Oferta</h3>
                </div>
                <div class="box-body">
                    <div class="form-group">
                        <label>Produto:</label>
                        <div>{{OfertaAlterar.product}}</div>
                    </div>
                    <div class="form-group">
                        <label>Embalagem:</label>
                        <select class="form-control" ng-model="OfertaAlterar.package_id" ng-change="AtualizaPrecoAlterar()">
                            <option value="{{package.id}}" ng-repeat="package in ListaEmbalagens">
                                {{package.name}} <small>({{package.size}} {{package.size>1?'garrafas':'garrafa'}})</small>
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Valor Unitário:</label>
                        <div class="input-group">
                            <span class="input-group-addon">R$</span>
                            <input type="number" min="1" step="0.1" class="form-control" ng-model="OfertaAlterar.price_unit"
                                ng-change="AtualizaPrecoAlterar()" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Valor Total:</label>
                        <div class="input-group">
                            <span class="input-group-addon">R$</span>
                            <input type="number" min="1" step="0.1" class="form-control" ng-model="OfertaAlterar.price"
                                disabled />
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" ng-model="OfertaAlterar.active" /> Ativar oferta
                        </label>
                    </div>
                </div>
                <div class="box-footer">
                    <button class="btn" ng-click="OfertaAlterar=false">Cancelar</button>
                    <button class="btn btn-primary pull-right" ng-click="SalvarOferta()">Salvar</button>
                </div>
                <div class="overlay" ng-if="ofertaLoad">
                    <i class="fa fa-sync fa-spin"></i>
                </div>
            </div>
            <div class="box box-info">
                <div class="box-header">
                    <h3 class="box-title">Cadastrar Oferta</h3>
                </div>
                <div class="box-body">
                    <div class="form-group">
                        <label>Produto:</label>
                        <select class="form-control" ng-model="NovaOferta.id_winehouse_product" ng-change="ExibeEstoque()">
                            <option value="">Selecione...</option>
                            <option value="{{produto.id}}" ng-repeat="produto in ListaProdutos">{{produto.name}}</option>
                        </select>
                        <small ng-if="NovaOferta.id_winehouse_product!=''">
                            <strong>Estoque Atual:</strong> {{EstoqueProdutoNovaOferta}}
                        </small>
                        <small ng-if="NovaOferta.id_winehouse_product!=''" class="pull-right">
                            <strong>Preço Atual:</strong> {{'R$' + PrecoProdutoNovaOferta}}
                        </small>
                    </div>
                    <div class="form-group">
                        <label>Embalagem:</label>
                        <select class="form-control" ng-model="NovaOferta.package_id">
                            <option value="{{package.id}}" ng-repeat="package in ListaEmbalagens">
                                {{package.name}} <small>({{package.size}} {{package.size>1?'garrafas':'garrafa'}})</small>
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Valor Unitário:</label>
                        <div class="input-group">
                            <span class="input-group-addon">R$</span>
                            <input type="number" min="1" step="0.1" class="form-control" ng-model="NovaOferta.price_unit" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Valor Total:</label>
                        <div class="input-group">
                            <span class="input-group-addon">R$</span>
                            <input type="number" min="1" step="0.1" class="form-control" ng-model="NovaOferta.price"
                                disabled />
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" ng-model="NovaOferta.active" /> Ativar oferta
                        </label>
                    </div>
                </div>
                <div class="box-footer">
                    <button class="btn btn-primary pull-right" ng-click="CriarOferta()">Cadastrar</button>
                </div>
                <div class="overlay" ng-if="ofertaLoad">
                    <i class="fa fa-sync fa-spin"></i>
                </div>
            </div>
        </div>
    </div>
</section>